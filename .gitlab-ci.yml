stages:
  - package
  - deploy

package:
  stage: package
  image: alpine:latest
  script:
    - apk add --update zip
    - mkdir dist
    - mv src/frontend/* dist
    - cd dist
    - zip frontend.zip ./*
  artifacts:
    name: "frontend-$CI_COMMIT_TAG"
    paths:
      - dist/frontend.zip
      - deploy.sh
  tags:
    - docker
    
deploy:
  stage: deploy
  script:
    - chmod 774 deploy.sh
    - ./deploy.sh
  variables:
    GIT_STRATEGY: none
  tags:
    - blue-green